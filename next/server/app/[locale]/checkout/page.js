(()=>{var e={};e.id=22,e.ids=[22],e.modules={1706:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(8835);if(!process.env.STRIPE_SECRET_KEY)throw Error("Missing Stripe secret key");let s=new r.A(process.env.STRIPE_SECRET_KEY,{apiVersion:"2025-05-28.basil"})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},18254:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"70c6f63c93dd4840043497687d65c268e56370956e":()=>i});var r=a(91199);a(42087);var s=a(1706);async function i(e,t,a){try{let r;if(e.filter(e=>!e.price).length>0)throw Error("Some of the items don't have a price");let i=await s.A.customers.list({email:t.customerEmail,limit:1});i.data.length>0&&(r=i.data[0].id);let l=e.reduce((e,t)=>e+ +t.price*t.quantity,0),n=t.couponDiscount&&t.finalTotal&&l>0?t.finalTotal/l:1;return(await s.A.checkout.sessions.create({customer:r,customer_creation:r?void 0:"always",customer_email:r?void 0:t.customerEmail,metadata:t,mode:"payment",payment_method_types:["card"],allow_promotion_codes:!0,cancel_url:`http://localhost:3000/${a}/checkout`,success_url:`http://localhost:3000/${a}/success?session_id={CHECKOUT_SESSION_ID}`,line_items:e.map(e=>{let t=Math.round(+e.price*n*100)/100,r=10*Math.round(1e3*t/10);return{price_data:{currency:"jod",unit_amount:r,product_data:{name:"ar"===a?e.name_ar:e.name_en||"Unnamed Product",description:"ar"===a?e.description_ar:e.description_en||"No description",metadata:{id:e.id},images:e.image&&e.image[0]?[`http://127.0.0.1:8000/storage/${e.image[0]}`]:void 0}},quantity:e.quantity}})})).url}catch(e){throw console.error("Error creating checkout session:",e),e}}(0,a(33331).D)([i]),(0,r.A)(i,"70c6f63c93dd4840043497687d65c268e56370956e",null)},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20412:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>L});var r=a(60687),s=a(43210),i=a(16189),l=a(24785),n=a(69977),o=a(77618);function d({currentLocale:e}){let t=(0,o.c3)("");return(0,r.jsx)("div",{className:"min-h-screen flex flex-col",style:{backgroundColor:"var(--primary-bg)"},dir:"ar"===e?"rtl":"ltr",role:"status","aria-live":"polite","aria-label":t("Cart.loading"),children:(0,r.jsxs)("main",{className:"container mx-auto max-w-full sm:max-w-7xl px-4 sm:px-6 lg:px-8 py-8 flex-grow",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-4 bg-gray-200 rounded-full animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsx)("div",{className:"mt-4 h-8 w-48 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 sm:gap-6 lg:gap-8",children:[(0,r.jsx)("div",{className:"lg:col-span-2 sm:py-6 lg:py-0 order-1 lg:order-2",children:(0,r.jsxs)("div",{className:"p-6 sm:p-8 w-[95%] md:w-full max-w-md sm:max-w-lg lg:max-w-2xl mx-auto min-h-[450px] flex flex-col rounded-lg shadow-md",style:{backgroundColor:"var(--primary-bg)"},children:[(0,r.jsx)("div",{className:"h-6 w-32 bg-gray-200 rounded animate-pulse mb-10"}),(0,r.jsx)("div",{className:"space-y-4 mb-10 flex-grow",children:[void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-4 border-b pb-4",style:{borderColor:"var(--secondary-bg)"},children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-gray-200 rounded animate-pulse"}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,r.jsx)("div",{className:"h-4 w-3/4 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-3 w-1/2 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-3 w-1/3 bg-gray-200 rounded animate-pulse"})]})]},t))}),(0,r.jsxs)("div",{className:"border-t pt-8 space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]})]})]})}),(0,r.jsx)("div",{className:"lg:col-span-3 order-2 lg:order-1",children:(0,r.jsxs)("div",{className:"p-6 sm:p-8 w-[95%] md:w-full max-w-md sm:max-w-lg lg:max-w-2xl mx-auto min-h-[450px] flex flex-col rounded-lg shadow-md",style:{backgroundColor:"var(--primary-bg)"},children:[(0,r.jsx)("div",{className:"h-6 w-40 bg-gray-200 rounded animate-pulse mb-6"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"h-5 w-32 bg-gray-200 rounded animate-pulse"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"h-10 w-full bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-8 w-8 bg-gray-200 rounded animate-pulse"})]})]}),(0,r.jsxs)("div",{className:"my-6",children:[(0,r.jsx)("div",{className:"h-5 w-24 bg-gray-200 rounded animate-pulse mb-2"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("div",{className:"h-10 w-full bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 w-24 bg-gray-200 rounded animate-pulse"})]})]}),(0,r.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,r.jsx)("div",{className:"h-10 w-32 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 w-40 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"})]})]}),(0,r.jsx)("div",{className:"h-12 w-full bg-gray-200 rounded animate-pulse mt-6"})]})})]})]})})}function c({error:e,currentLocale:t}){return(0,r.jsx)("div",{className:"text-center py-10 text-red-500",role:"alert","aria-live":"polite",dir:"ar"===t?"rtl":"ltr",children:(0,r.jsx)("p",{children:e})})}var m=a(85814),u=a.n(m);function p({currentLocale:e}){let t=(0,o.c3)("");return(0,r.jsxs)("div",{className:"text-center py-10",dir:"ar"===e?"rtl":"ltr",children:[(0,r.jsx)("p",{className:"text-lg",style:{color:"var(--text-primary)"},children:t("Cart.empty")}),(0,r.jsx)(u(),{href:`/${e}/products`,className:"mt-4 inline-block px-4 py-2 text-white rounded-md",style:{backgroundColor:"var(--accent-color)"},children:t("Cart.continueShopping")})]})}var x=a(30474),h=a(42703),g=a(96241);function f({couponApplied:e,couponDiscount:t}){let a=(0,o.c3)(""),s="en"===(0,i.usePathname)().split("/")[1]?"en":"ar",{items:n,isLoading:d,error:c}=(0,l.useCartStore)(),m=((0,h._)(".footer"),n.reduce((e,t)=>e+(parseFloat(t.price)||0)*t.quantity,0)),p=m+2+0,f=e?p*(1-t):p;return d?(0,r.jsx)("div",{className:"text-center py-10",role:"alert","aria-live":"polite",children:(0,r.jsx)("p",{className:"text-lg",style:{color:"var(--text-primary)"},children:a("Cart.loading")})}):c?(0,r.jsx)("div",{className:"text-center py-10 text-red-500",role:"alert","aria-live":"polite",children:(0,r.jsx)("p",{children:c})}):0===n.length?(0,r.jsxs)("div",{className:"text-center py-10",children:[(0,r.jsx)("p",{className:"text-lg",style:{color:"var(--text-primary)"},children:a("Cart.empty")}),(0,r.jsx)(u(),{href:`/${s}/products`,className:"mt-4 inline-block px-4 py-2 text-white rounded-md",style:{backgroundColor:"var(--accent-color)"},children:a("Cart.continueShopping")})]}):(0,r.jsxs)("div",{className:"sticky-container p-6 sm:p-8 w-[95%] md:w-full max-w-md sm:max-w-lg lg:max-w-2xl lg:mx-7 min-h-[450px] mx-auto flex flex-col z-10 lg:sticky lg:top-25",role:"region","aria-label":a("checkout.orderSummary"),style:{backgroundColor:"var(--primary-bg)"},children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-10",style:{color:"var(--text-primary)"},children:a("checkout.orderSummary")}),(0,r.jsx)("div",{className:"space-y-4 mb-10 flex-grow overflow-y-auto",style:{maxHeight:"calc(50vh - 100px)"},children:n.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-4 border-b pb-4",style:{borderColor:"var(--secondary-bg)"},children:[(0,r.jsx)(u(),{href:`/${s}/products/${e.product_id}`,className:"gap-4",passHref:!0,children:(0,r.jsx)("div",{className:"w-20 h-20 relative",children:(0,r.jsx)(x.default,{src:"http://127.0.0.1:8000"+e.image[0],alt:("ar"===s?e.name_ar:e.name_en)||"Product Image",fill:!0,className:"object-cover rounded",loading:"lazy"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-medium text-sm",style:{color:"var(--text-primary)"},children:"ar"===s?e.name_ar:e.name_en||e.name_ar}),(0,r.jsxs)("p",{className:"text-xs",style:{color:"var(--text-gray)"},children:[a("checkout.price"),": ",(0,g.$)(e.price,s)]}),(0,r.jsxs)("p",{className:"text-xs",style:{color:"var(--text-gray)"},children:[a("checkout.quantity"),": ",e.quantity]})]})]},e.id))}),(0,r.jsx)("div",{className:"border-t pt-8 mb-10",style:{borderColor:"var(--accent-color)"},children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{style:{color:"var(--text-gray)"},children:a("Cart.subtotal")}),(0,r.jsx)("span",{className:"font-medium",children:(0,g.$)(m.toFixed(2),s)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{style:{color:"var(--text-gray)"},dir:"ar"===s?"rtl":"ltr",children:a("Cart.shipping")}),(0,r.jsx)("span",{className:"font-medium",children:(0,g.$)("2.00",s)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{style:{color:"var(--text-gray)"},children:a("Cart.tax")}),(0,r.jsx)("span",{className:"font-medium",children:(0,g.$)("0.00",s)})]}),e?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{style:{color:"var(--text-gray)"},children:a("Cart.originalTotal")}),(0,r.jsx)("span",{className:"line-through",children:(0,g.$)(p.toFixed(2),s)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-xl font-semibold",children:a("Cart.discountedTotal")}),(0,r.jsx)("span",{className:"text-xl font-bold",children:(0,g.$)(f.toFixed(2),s)})]})]}):(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-xl font-semibold",children:a("Cart.total")}),(0,r.jsx)("span",{className:"text-xl font-bold",children:(0,g.$)(p.toFixed(2),s)})]})]})})]})}var y=a(97461),v=a.n(y);a(90895);var N=a(84027),b=a(29640);function j({userData:e,addresses:t,setAddresses:a,defaultAddressId:i,formData:l,formErrors:d,handleGiftInputChange:c,handleGiftPhoneChange:m,handleGiftToggle:p,currentLocale:x,setDefaultAddressId:h}){let g=(0,o.c3)("checkout"),f=(0,s.useRef)(e.phone_number),y=(0,s.useRef)(l.giftPhoneNumber),[j,w]=(0,s.useState)(void 0),_=async e=>{let r=parseInt(e.target.value);if(!r){w(g("errors.addressRequired")),h(null);return}try{await (0,n.y_)(r),a(t.map(e=>({...e,is_default:e.id===r}))),h(r),w(void 0)}catch(e){console.error("Error setting default address:",e),w(g("errors.addressChangeFailed"))}};return(0,r.jsxs)("div",{className:"space-y-6",dir:"ar"===x?"rtl":"ltr",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--text-primary)"},children:g("billingDetails")}),(0,r.jsxs)(b.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-[var(--text-primary)]",children:g("firstName")}),(0,r.jsx)("input",{type:"text",name:"first_name",value:e.first_name,disabled:!0,className:"w-full rounded-lg border px-4 py-3 text-sm bg-gray-100 cursor-not-allowed border-[var(--secondary-bg)]","aria-label":g("firstName")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-[var(--text-primary)]",children:g("lastName")}),(0,r.jsx)("input",{type:"text",name:"last_name",value:e.last_name,disabled:!0,className:"w-full rounded-lg border px-4 py-3 text-sm bg-gray-100 cursor-not-allowed border-[var(--secondary-bg)]","aria-label":g("lastName")})]})]}),(0,r.jsxs)(b.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"mb-6",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-[var(--text-primary)]",children:g("phoneNumber")}),(0,r.jsx)("div",{dir:"ltr",children:(0,r.jsx)(v(),{country:"jo",value:f.current||"",disabled:!0,containerClass:"w-full",inputProps:{name:"phone_number",className:"w-full pl-16 py-3 rounded-lg border text-sm bg-gray-100 cursor-not-allowed border-[var(--secondary-bg)]"},buttonStyle:{border:"none",backgroundColor:"transparent",padding:"8px",cursor:"not-allowed",left:"0",top:"0",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},dropdownStyle:{display:"none"}})})]}),(0,r.jsxs)(b.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"mb-6",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-[var(--text-primary)]",children:g("address")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("select",{name:"address",value:i||"",onChange:_,className:`w-full rounded-lg border px-4 py-3 text-sm focus:outline-none focus:ring-2 transition-colors ${j?"border-red-500":"border-[var(--secondary-bg)]"}`,"aria-invalid":!!j,"aria-describedby":j?"address-error":void 0,children:[(0,r.jsx)("option",{value:"",children:g("selectAddress")}),t.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.title," - ",e.city,", ",e.country_name||e.country_id]},e.id))]}),(0,r.jsx)(u(),{href:`/${x}/address`,children:(0,r.jsx)(b.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",className:"p-2 text-[var(--text-gray)] hover:text-[var(--accent-color)]",title:g("manageAddresses"),children:(0,r.jsx)(N.A,{className:"w-5 h-5"})})})]}),j&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",id:"address-error",children:j})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 my-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"isGift",checked:l.isGift,onChange:p,className:"h-4 w-4"}),(0,r.jsx)("label",{htmlFor:"isGift",className:"text-sm",style:{color:"var(--text-primary)"},children:g("isGift")})]}),l.isGift&&(0,r.jsxs)(b.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"space-y-4 mt-4 my-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",name:"giftFirstName",placeholder:g("giftFirstName"),value:l.giftFirstName,onChange:c,className:`w-full rounded-md border px-4 py-3 text-sm focus:outline-none focus:ring-2 transition-colors ${d.giftFirstName?"border-red-500":"border-[var(--secondary-bg)]"}`,"aria-invalid":!!d.giftFirstName,"aria-describedby":d.giftFirstName?"giftFirstName-error":void 0}),d.giftFirstName&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",id:"giftFirstName-error",children:d.giftFirstName})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",name:"giftLastName",placeholder:g("giftLastName"),value:l.giftLastName,onChange:c,className:`w-full rounded-md border px-4 py-3 text-sm focus:outline-none focus:ring-2 transition-colors ${d.giftLastName?"border-red-500":"border-[var(--secondary-bg)]"}`,"aria-invalid":!!d.giftLastName,"aria-describedby":d.giftLastName?"giftLastName-error":void 0}),d.giftLastName&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",id:"giftLastName-error",children:d.giftLastName})]})]}),(0,r.jsxs)("div",{dir:"ltr",children:[(0,r.jsx)(v(),{country:"jo",value:y.current||"",onChange:e=>{y.current=e,m(e)},containerClass:"w-full",inputProps:{name:"giftPhoneNumber",required:!0,className:`w-full pl-16 py-3 rounded-md border text-sm focus:outline-none focus:ring-2 transition-colors ${d.giftPhoneNumber?"border-red-500":"border-[var(--secondary-bg)]"}`},buttonStyle:{border:"none",backgroundColor:"transparent",padding:"8px",cursor:"pointer",left:"0",top:"0",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},dropdownStyle:{zIndex:1e3,top:"100%",left:"0"}}),d.giftPhoneNumber&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",id:"giftPhoneNumber-error",children:d.giftPhoneNumber})]})]})]})}var w=a(85778);function _({paymentMethod:e,handlePaymentMethodChange:t}){let a=(0,o.c3)("checkout");return(0,r.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,r.jsxs)("button",{className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${"credit-card"===e?"bg-[var(--secondary-bg)] text-[var(--text-white)]":"bg-[var(--primary-bg)] text-[var(--text-gray)] hover:bg-[var(--secondary-bg)] hover:text-[var(--text-white)]"}`,onClick:()=>t("credit-card"),"aria-pressed":"credit-card"===e,children:[(0,r.jsx)(w.A,{className:"h-4 w-4"}),a("creditCard")]}),(0,r.jsxs)("button",{className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${"cash"===e?"bg-[var(--secondary-bg)] text-[var(--text-white)]":"bg-[var(--primary-bg)] text-[var(--text-gray)] hover:bg-[var(--secondary-bg)] hover:text-[var(--text-white)]"}`,onClick:()=>t("cash"),"aria-pressed":"cash"===e,children:[(0,r.jsx)("span",{className:"text-lg",children:"$"}),a("cashOnDelivery")]})]})}var C=a(41862),k=a(65069),S=a(6475);let P=(0,S.createServerReference)("70c6f63c93dd4840043497687d65c268e56370956e",S.callServer,void 0,S.findSourceMapURL,"createCheckoutSession");function A({formData:e,setFormErrors:t,isProcessing:a,setIsProcessing:s,currentLocale:l,items:d,userData:c,addresses:m,defaultAddressId:u,total:p,couponApplied:x,couponDiscount:h}){let g=(0,o.c3)("checkout"),f=(0,i.useRouter)(),y=m.find(e=>e.id===u)||null,v=()=>{let t={};if(e.isGift){e.giftFirstName.trim()||(t.giftFirstName=g("errors.giftFirstNameRequired")),e.giftLastName.trim()||(t.giftLastName=g("errors.giftLastNameRequired"));let a=(0,k.l)(`+${e.giftPhoneNumber}`);a&&a.isValid()||(t.giftPhoneNumber=g("errors.invalidGiftPhone"))}return t},N=async()=>{if(!y||!y.address_line?.trim()){t({address:g("errors.addressIncomplete")});return}let a=v();if(Object.keys(a).length>0){t(a),a.giftFirstName?document.getElementsByName("giftFirstName")[0]?.focus():a.giftLastName?document.getElementsByName("giftLastName")[0]?.focus():a.giftPhoneNumber&&document.getElementsByName("giftPhoneNumber")[0]?.focus();return}s(!0);try{let t=localStorage.getItem("userId"),a=localStorage.getItem("token");if(!t)throw Error("User ID not found");if(!a)throw Error("Authentication token not found");let r=localStorage.getItem("appliedCoupon"),s=r?JSON.parse(r):null,i=x&&h>0?p-h:p,o={customer_id:t,address_id:u,items:d.map(e=>({product_id:e.product_id,price:e.price.toString(),quantity:e.quantity,name_ar:e.name_ar,name_en:e.name_en})),is_gift:e.isGift,gift_first_name:e.isGift?e.giftFirstName:void 0,gift_last_name:e.isGift?e.giftLastName:void 0,gift_phone_number:e.isGift?e.giftPhoneNumber:void 0,coupon_id:x&&s?s.id:null,total:i,delivery_cost:2,orderCode:"ORD"+new Date().getTime().toString(),payment_method:e.paymentMethod,address_line:y.address_line,city:y.city,country_name:y.country_name};if("cash"===e.paymentMethod){let r=await (0,n.Pt)(o,a),s={orderId:r&&r.data.order_code.toString(),items:d.map(e=>({id:e.product_id.toString(),name_ar:e.name_ar,name_en:e.name_en,quantity:e.quantity,price:e.price.toString()})),total:i.toFixed(3),orderDate:new Date().toISOString(),couponApplied:x,couponDiscount:h,billing:{first_name:e.isGift?e.giftFirstName:c.first_name,last_name:e.isGift?e.giftLastName:c.last_name,phone_number:e.isGift?e.giftPhoneNumber:c.phone_number,address_line:y.address_line,city:y.city,country:y.country_name},gift:e.isGift?{firstName:e.giftFirstName,lastName:e.giftLastName,phoneNumber:e.giftPhoneNumber}:null};localStorage.setItem("lastOrder",JSON.stringify(s)),await (0,n.sX)(t,l,a),x&&localStorage.removeItem("appliedCoupon"),f.push(`/${l}/success`)}else if("credit-card"===e.paymentMethod){let e={orderNumber:o.orderCode||"",customerName:`${c.first_name} ${c.last_name}`,customerEmail:c.email||"UNKNOWN",userId:t,couponDiscount:x?h:void 0,finalTotal:i,checkoutData:JSON.stringify(o)},a=await P(d,e,l);a&&(window.location.href=a)}}catch(e){console.error("Checkout error:",e),t({general:g("errors.checkoutFailed")})}finally{s(!1)}},j=()=>!!(a||0===d.length||!y||e.isGift&&(!e.giftFirstName?.trim()||!e.giftLastName?.trim()||!e.giftPhoneNumber?.trim())||"cash"===e.paymentMethod&&(e.giftFirstName?.trim()||e.giftLastName?.trim()||e.giftPhoneNumber?.trim()))||(e.paymentMethod,!1);return(0,r.jsx)(b.P.button,{onClick:N,disabled:j(),className:`w-full py-4 mt-6 text-white font-medium rounded-md transition-colors flex items-center justify-center ${j()?"bg-gray-400 cursor-not-allowed":"bg-[var(--secondary-bg)] hover:bg-[var(--accent-color)]"}`,"aria-label":a?g("processing"):g("confirm"),initial:{opacity:0,y:10},animate:{opacity:1,y:0},whileHover:j()?{}:{scale:1.05,boxShadow:"0 0 8px rgba(0, 0, 0, 0.2)"},children:a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.A,{className:"animate-spin h-5 w-5 mr-2"}),g("processing")]}):g("confirm")})}function F({userData:e,addresses:t,setAddresses:a,defaultAddressId:d,setDefaultAddressId:c,couponCode:m,setCouponCode:u,couponApplied:p,setCouponApplied:x,couponDiscount:f,setCouponDiscount:y,couponError:v,setCouponError:N}){let b=(0,o.c3)("checkout"),w="en"===(0,i.usePathname)().split("/")[1]?"en":"ar",{items:C}=(0,l.useCartStore)(),[k,S]=((0,h._)(".footer"),(0,s.useState)(!1)),[P,F]=(0,s.useState)({cardNumber:"",cardHolder:"",expiryDate:"",cvv:"",paymentMethod:"credit-card",isGift:!1,giftFirstName:"",giftLastName:"",giftPhoneNumber:""}),[D,$]=(0,s.useState)({}),[E,L]=(0,s.useState)([]),I=C.reduce((e,t)=>e+(parseFloat(t.price)||0)*t.quantity,0)+0,q=(p?I*(1-f):I)+2,M=t.find(e=>e.id===d),G=M?.country_id||null,R=async()=>{try{let e=await (0,n.VY)(m,G);x(!0),y(e.data.amount/100),N(null),localStorage.setItem("appliedCoupon",JSON.stringify(e.data))}catch(t){let e=t instanceof Error?t:Error(b("errors.invalidCoupon"));x(!1),y(0),N(e.message),localStorage.removeItem("appliedCoupon")}};return(0,r.jsxs)("div",{className:"sticky-container p-6 sm:p-8 w-[95%] md:w-full max-w-md sm:max-w-lg lg:max-w-2xl mx-auto lg:mx-7 min-h-[450px] sm:mx-auto md:mx-auto flex flex-col z-10 rounded-lg shadow-md lg:sticky lg:top-25",style:{backgroundColor:"var(--primary-bg)",borderColor:"var(--secondary-bg)"},role:"region","aria-label":b("paymentDetails"),children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-6",style:{color:"var(--text-primary)"},children:b("paymentDetails")}),(0,r.jsx)(j,{userData:e,addresses:t,setAddresses:a,defaultAddressId:d,setDefaultAddressId:c,formData:P,formErrors:D,handleGiftInputChange:e=>{let{name:t,value:a}=e.target;F(e=>({...e,[t]:a})),$(e=>({...e,[t]:void 0}))},handleGiftPhoneChange:e=>{F(t=>({...t,giftPhoneNumber:e})),$(e=>({...e,giftPhoneNumber:void 0}))},handleGiftToggle:()=>{F(e=>({...e,isGift:!e.isGift,giftFirstName:"",giftLastName:"",giftPhoneNumber:""})),$(e=>({...e,giftFirstName:void 0,giftLastName:void 0,giftPhoneNumber:void 0}))},currentLocale:w}),E.length>0&&(0,r.jsxs)("div",{className:"my-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",style:{color:"var(--text-primary)"},children:b("coupon")}),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("span",{className:"text-sm",style:{color:"var(--text-gray)"},children:[b("couponCode"),":"]}),E.map(e=>(0,r.jsx)("span",{className:"text-cyan-700 ml-2",children:e.code},e.id))]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:m,onChange:e=>{u(e.target.value),N(null)},placeholder:b("enterCoupon"),className:"w-full rounded-md border px-4 py-3 text-sm focus:outline-none focus:ring-2 transition-colors border-[var(--secondary-bg)]"}),(0,r.jsx)("button",{onClick:R,className:"px-4 py-2 text-white rounded-md",style:{backgroundColor:"var(--accent-color)"},children:b("applyCoupon")})]}),v&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v}),p&&(0,r.jsxs)("div",{className:"text-sm mt-2",style:{color:"var(--text-gray)"},children:[(0,r.jsxs)("p",{children:[b("originalTotal"),":"," ",(0,r.jsx)("span",{className:"line-through",children:(0,g.$)(I.toFixed(2),w)})]}),(0,r.jsxs)("p",{children:[b("discountedTotal"),":"," ",(0,r.jsx)("span",{className:"font-bold",children:(0,g.$)(q.toFixed(2),w)})]})]})]}),(0,r.jsx)(_,{paymentMethod:P.paymentMethod,handlePaymentMethodChange:e=>{F(t=>({...t,paymentMethod:e})),$({})}}),(0,r.jsx)(A,{formData:P,setFormErrors:$,isProcessing:k,setIsProcessing:S,currentLocale:w,items:C,userData:e,addresses:t,defaultAddressId:d,total:q,couponApplied:p,couponDiscount:f})]})}function D({userData:e,addresses:t,setAddresses:a,defaultAddressId:s,setDefaultAddressId:i,couponCode:l,setCouponCode:n,couponApplied:o,setCouponApplied:d,couponDiscount:c,setCouponDiscount:m,couponError:u,setCouponError:p,currentLocale:x}){return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 sm:gap-6 lg:gap-8",dir:"ar"===x?"rtl":"ltr",children:[(0,r.jsx)("div",{className:"lg:col-span-2 sm:py-6 lg:py-0 order-1 lg:order-2",children:(0,r.jsx)(f,{couponApplied:o,couponDiscount:c})}),(0,r.jsx)("div",{className:"lg:col-span-3 order-2 lg:order-1",children:(0,r.jsx)(F,{userData:e,addresses:t,setAddresses:a,defaultAddressId:s,setDefaultAddressId:i,couponCode:l,setCouponCode:n,couponApplied:o,setCouponApplied:d,couponDiscount:c,setCouponDiscount:m,couponError:u,setCouponError:p,currentLocale:x})})]})}var $=a(39192);function E({currentLocale:e}){let t=(0,o.c3)("");return(0,r.jsxs)("div",{className:"mb-8",dir:"ar"===e?"rtl":"ltr",children:[(0,r.jsx)($.A,{pageName:"checkout"}),(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold mt-4",style:{color:"var(--text-primary)"},children:t("checkout.title")})]})}function L(){let e=(0,i.usePathname)();(0,i.useRouter)();let t="en"===e.split("/")[1]?"en":"ar",{items:a,syncWithBackend:n,isLoading:o,error:m}=(0,l.useCartStore)(),[u,x]=(0,s.useState)(null),[h,g]=(0,s.useState)([]),[f,y]=(0,s.useState)(null),[v,N]=(0,s.useState)(!0),[b,j]=(0,s.useState)(""),[w,_]=(0,s.useState)(!1),[C,k]=(0,s.useState)(0),[S,P]=(0,s.useState)(null);return(0,r.jsx)("div",{className:"min-h-screen flex flex-col",style:{backgroundColor:"var(--primary-bg)"},dir:"ar"===t?"rtl":"ltr",children:(0,r.jsxs)("main",{className:"container mx-auto max-w-full sm:max-w-7xl px-4 sm:px-6 lg:px-8 py-8 flex-grow",children:[(0,r.jsx)(E,{currentLocale:t}),v||!u?(0,r.jsx)(d,{currentLocale:t}):o?(0,r.jsx)(d,{currentLocale:t}):m?(0,r.jsx)(c,{error:m,currentLocale:t}):0===a.length?(0,r.jsx)(p,{currentLocale:t}):(0,r.jsx)(D,{userData:u,addresses:h,setAddresses:g,defaultAddressId:f,setDefaultAddressId:y,couponCode:b,setCouponCode:j,couponApplied:w,setCouponApplied:_,couponDiscount:C,setCouponDiscount:k,couponError:S,setCouponError:P,currentLocale:t})]})})}},26064:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var r=a(65239),s=a(48088),i=a(88170),l=a.n(i),n=a(30893),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d={children:["",{children:["[locale]",{children:["checkout",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,64036)),"C:\\Users\\Moham\\Desktop\\shatleh\\client\\src\\app\\[locale]\\checkout\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,11434)),"C:\\Users\\Moham\\Desktop\\shatleh\\client\\src\\app\\[locale]\\layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(a.t.bind(a,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\Moham\\Desktop\\shatleh\\client\\src\\app\\[locale]\\checkout\\page.tsx"],m={require:a,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/[locale]/checkout/page",pathname:"/[locale]/checkout",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},36301:(e,t,a)=>{Promise.resolve().then(a.bind(a,64036))},39192:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var r=a(60687),s=a(85814),i=a.n(s),l=a(47033),n=a(14952),o=a(77618),d=a(16189),c=a(43210);let m=(0,c.memo)(function({pageName:e,product:t}){let a=(0,o.c3)(""),s=(0,d.usePathname)(),m=s.split("/")[1]||"ar",u=a(`pages.${e.toLocaleLowerCase()}`);return"ar"===m?(0,r.jsxs)("div",{className:"flex items-center text-sm mb-2",children:[(0,r.jsx)(i(),{href:"/",className:"text-[#025162]",children:a("home.title")}),(0,r.jsx)(l.A,{className:"h-4 w-4 mx-1 text-[#80ce97]"}),(0,r.jsx)(i(),{href:`/${m}/${e}`,className:"text-[#025162]",children:(0,r.jsx)("span",{className:"text-[#025162]",children:u})}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.A,{className:"h-4 w-4 mx-1 text-[#80ce97]"}),(0,r.jsx)("span",{className:"text-[#025162]",children:t})]})]}):(0,r.jsxs)("div",{className:"flex items-center text-sm mb-2",children:[(0,r.jsx)(i(),{href:"/",className:"text-[#025162]",children:a("home.title")}),s.split("/").map((e,t)=>1!==t&&0!==t&&isNaN(parseInt(e))?(0,r.jsxs)(c.Fragment,{children:[(0,r.jsx)(n.A,{className:"h-4 w-4 mx-1 text-[#80ce97]"}),(0,r.jsx)(i(),{href:`/${e}`,className:"text-[#025162]",children:(0,r.jsx)("span",{className:"text-[#025162]",children:e})})]},e):null),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{className:"h-4 w-4 mx-1 text-[#80ce97]"}),(0,r.jsx)("span",{className:"text-[#025162]",children:t})]})]})})},41862:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(62688).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},42703:(e,t,a)=>{"use strict";a.d(t,{_:()=>s});var r=a(43210);function s(e){let[t,a]=(0,r.useState)(!1);return t}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64036:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Moham\\\\Desktop\\\\shatleh\\\\client\\\\src\\\\app\\\\[locale]\\\\checkout\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Moham\\Desktop\\shatleh\\client\\src\\app\\[locale]\\checkout\\page.tsx","default")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},83565:(e,t,a)=>{Promise.resolve().then(a.bind(a,20412))},84027:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(62688).A)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},85778:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(62688).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},94735:e=>{"use strict";e.exports=require("events")},96241:(e,t,a)=>{"use strict";function r(e,t){let a="string"==typeof e?parseFloat(e):e;if(isNaN(a))return"ar"===t?"غير متوفر":"Not available";let r=new Intl.NumberFormat("ar"===t?"ar-JO":"en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return`${r.format(a)} ${"ar"===t?"د.أ":"JD"}`}function s(e,t,a,r=10){if(!e||!e.categories||0===e.categories.length)return t.filter(t=>t.id!==e?.id).sort(()=>Math.random()-.5).slice(0,r);let i=e.categories.filter(e=>null===e.parent_id).map(e=>e.id),l=e.categories.filter(e=>null!==e.parent_id).map(e=>e.id),n=new Set;for(let e of l)for(let t of a)t.subcategories.some(t=>t.id===e)&&n.add(t.id);let o=[...t.filter(t=>{if(t.id===e.id)return!1;let r=t.categories.map(e=>e.id);if(r.some(e=>r.includes(e))||r.some(e=>n.has(e)))return!0;for(let e of i)for(let t of a)if(t.id===e&&r.some(e=>t.subcategories.some(t=>t.id===e)))return!0;return!1})];if(o.length<r){let a=new Set(o.map(e=>e.id).concat(e.id)),s=t.filter(e=>!a.has(e.id)).sort(()=>Math.random()-.5);o.push(...s.slice(0,r-o.length))}return o.sort(()=>Math.random()-.5).slice(0,r)}a.d(t,{$:()=>r,S:()=>s})}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[825,485,640,523,692,69,932],()=>a(26064));module.exports=r})();