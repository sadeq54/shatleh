(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7022],{381:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1004:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var r=a(5155),s=a(6874),i=a.n(s),l=a(2355),n=a(3052),o=a(7652),d=a(5695),c=a(2115);let m=(0,c.memo)(function(e){let{pageName:t,product:a}=e,s=(0,o.c3)(""),m=(0,d.usePathname)(),u=m.split("/")[1]||"ar",p=s("pages.".concat(t.toLocaleLowerCase()));return"ar"===u?(0,r.jsxs)("div",{className:"flex items-center text-sm mb-2",children:[(0,r.jsx)(i(),{href:"/",className:"text-[#025162]",children:s("home.title")}),(0,r.jsx)(l.A,{className:"h-4 w-4 mx-1 text-[#80ce97]"}),(0,r.jsx)(i(),{href:"/".concat(u,"/").concat(t),className:"text-[#025162]",children:(0,r.jsx)("span",{className:"text-[#025162]",children:p})}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.A,{className:"h-4 w-4 mx-1 text-[#80ce97]"}),(0,r.jsx)("span",{className:"text-[#025162]",children:a})]})]}):(0,r.jsxs)("div",{className:"flex items-center text-sm mb-2",children:[(0,r.jsx)(i(),{href:"/",className:"text-[#025162]",children:s("home.title")}),m.split("/").map((e,t)=>1!==t&&0!==t&&isNaN(parseInt(e))?(0,r.jsxs)(c.Fragment,{children:[(0,r.jsx)(n.A,{className:"h-4 w-4 mx-1 text-[#80ce97]"}),(0,r.jsx)(i(),{href:"/".concat(e),className:"text-[#025162]",children:(0,r.jsx)("span",{className:"text-[#025162]",children:e})})]},e):null),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{className:"h-4 w-4 mx-1 text-[#80ce97]"}),(0,r.jsx)("span",{className:"text-[#025162]",children:a})]})]})})},1154:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1586:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},2355:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},2629:(e,t,a)=>{"use strict";a.d(t,{_:()=>s});var r=a(2115);function s(e){let[t,a]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let t=document.querySelector(e);if(!t)return;let r=new IntersectionObserver(e=>{let[t]=e;a(t.isIntersecting)},{threshold:0});return r.observe(t),()=>r.disconnect()},[e]),t}},3052:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},3999:(e,t,a)=>{"use strict";function r(e,t){let a="string"==typeof e?parseFloat(e):e;if(isNaN(a))return"ar"===t?"غير متوفر":"Not available";let r=new Intl.NumberFormat("ar"===t?"ar-JO":"en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return"".concat(r.format(a)," ").concat("ar"===t?"د.أ":"JD")}function s(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;if(!e||!e.categories||0===e.categories.length)return t.filter(t=>t.id!==(null==e?void 0:e.id)).sort(()=>Math.random()-.5).slice(0,r);let s=e.categories.filter(e=>null===e.parent_id).map(e=>e.id),i=e.categories.filter(e=>null!==e.parent_id).map(e=>e.id),l=new Set;for(let e of i)for(let t of a)t.subcategories.some(t=>t.id===e)&&l.add(t.id);let n=[...t.filter(t=>{if(t.id===e.id)return!1;let r=t.categories.map(e=>e.id);if(r.some(e=>r.includes(e))||r.some(e=>l.has(e)))return!0;for(let e of s)for(let t of a)if(t.id===e&&r.some(e=>t.subcategories.some(t=>t.id===e)))return!0;return!1})];if(n.length<r){let a=new Set(n.map(e=>e.id).concat(e.id)),s=t.filter(e=>!a.has(e.id)).sort(()=>Math.random()-.5);n.push(...s.slice(0,r-n.length))}return n.sort(()=>Math.random()-.5).slice(0,r)}a.d(t,{$:()=>r,S:()=>s})},4477:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{callServer:function(){return r.callServer},createServerReference:function(){return i},findSourceMapURL:function(){return s.findSourceMapURL}});let r=a(3806),s=a(1818),i=a(4979).createServerReference},5203:(e,t,a)=>{"use strict";a.r(t),a.d(t,{useCartStore:()=>n});var r=a(5453),s=a(6786),i=a(6720);let l=e=>e instanceof Error?e.message.includes("customer_id")||e.message.includes("The selected")?"Invalid user ID. Please log in again or contact support.":e.message.includes("POST method is not supported")?"Cart sync failed due to server configuration. Please try again later.":e.message||"Operation failed. Please try again.":"Operation failed.",n=(0,r.v)()((0,s.eh)((0,s.Zr)((e,t)=>({items:[],isLoading:!1,error:null,addItem:async(a,r,s)=>{e({isLoading:!0,error:null});let n=t().items;try{let l=n.find(e=>e.product_id===a.product_id),o=l?l.quantity+1:1,d={...a,id:(null==l?void 0:l.id)||Date.now(),customer_id:r||"guest",quantity:o};l?e({items:n.map(e=>e.product_id===a.product_id?d:e)}):e({items:[...n,d]}),r&&(await (0,i.V2)({customer_id:r,product_id:a.product_id,quantity:o},s),await t().syncWithBackend(r,s))}catch(t){console.error("Error adding item to cart:",t),e({items:n,error:l(t)})}finally{e({isLoading:!1})}},removeItem:async(a,r,s)=>{e({isLoading:!0,error:null});let n=t().items;try{let l=n.find(e=>e.product_id===a);if(!l)return;e({items:n.filter(e=>e.product_id!==a)}),r&&(await (0,i.V2)({customer_id:r,product_id:l.product_id,quantity:0},s),await t().syncWithBackend(r,s))}catch(t){console.error("Error removing item from cart:",t),e({items:n,error:l(t)})}finally{e({isLoading:!1})}},updateQuantity:async(a,r,s,n)=>{e({isLoading:!0,error:null});let o=t().items;try{let l=o.find(e=>e.product_id===a);if(!l)return;r<=0?e({items:o.filter(e=>e.product_id!==a)}):e({items:o.map(e=>e.product_id===a?{...e,quantity:r}:e)}),s&&(await (0,i.V2)({customer_id:s,product_id:l.product_id,quantity:r},n),await t().syncWithBackend(s,n))}catch(t){console.error("Error updating cart item quantity:",t),e({items:o,error:l(t)})}finally{e({isLoading:!1})}},clearCart:async(a,r)=>{e({isLoading:!0,error:null});let s=t().items,n=localStorage.getItem("token");try{e({items:[]}),a&&await (0,i.sX)(a,r,n),await t().syncWithBackend(a,r)}catch(t){console.error("Error clearing cart:",t),e({items:s,error:l(t)})}finally{e({isLoading:!1})}},syncWithBackend:async(a,r)=>{if(!a){console.warn("No user authenticated or server-side, skipping cart sync");return}if(!localStorage.getItem("token")){console.warn("No token found, skipping cart sync");return}e({isLoading:!0,error:null});try{let s=(await (0,i.Fy)(a,r)).map(e=>({id:e.id,product_id:e.product_id,customer_id:e.customer_id,name_en:e.name_en,name_ar:e.name_ar,description_en:e.description_en,description_ar:e.description_ar,price:e.price,image:e.image,quantity:e.quantity})),l=t().items.filter(e=>"guest"===e.customer_id||e.customer_id===a),n=[];for(let e of s)n.push(e);for(let e of l)n.some(t=>t.product_id===e.product_id)||n.push({...e,customer_id:a});for(let t of(e({items:n,error:null}),n))await (0,i.V2)({customer_id:a,product_id:t.product_id,quantity:t.quantity},r)}catch(t){console.error("Error syncing with backend:",t),e({error:l(t)})}finally{e({isLoading:!1})}},logout:()=>{e({items:[],error:null}),console.log("Cart cleared on logout")},total:()=>t().items.reduce((e,t)=>e+(parseFloat(t.price)||0)*t.quantity,0),totalItems:()=>t().items.reduce((e,t)=>e+t.quantity,0)}),{name:"cart-storage",partialize:e=>({items:e.items})})));(async()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("userId");if(e&&t)try{let e=localStorage.getItem("locale")||"ar";await n.getState().syncWithBackend(t,e)}catch(e){console.error("Initial cart load error:",e)}})()},7776:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>E});var r=a(5155),s=a(2115),i=a(5695),l=a(5203),n=a(6720),o=a(7652);function d(e){let{currentLocale:t}=e,a=(0,o.c3)("");return(0,r.jsx)("div",{className:"min-h-screen flex flex-col",style:{backgroundColor:"var(--primary-bg)"},dir:"ar"===t?"rtl":"ltr",role:"status","aria-live":"polite","aria-label":a("Cart.loading"),children:(0,r.jsxs)("main",{className:"container mx-auto max-w-full sm:max-w-7xl px-4 sm:px-6 lg:px-8 py-8 flex-grow",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-4 bg-gray-200 rounded-full animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsx)("div",{className:"mt-4 h-8 w-48 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 sm:gap-6 lg:gap-8",children:[(0,r.jsx)("div",{className:"lg:col-span-2 sm:py-6 lg:py-0 order-1 lg:order-2",children:(0,r.jsxs)("div",{className:"p-6 sm:p-8 w-[95%] md:w-full max-w-md sm:max-w-lg lg:max-w-2xl mx-auto min-h-[450px] flex flex-col rounded-lg shadow-md",style:{backgroundColor:"var(--primary-bg)"},children:[(0,r.jsx)("div",{className:"h-6 w-32 bg-gray-200 rounded animate-pulse mb-10"}),(0,r.jsx)("div",{className:"space-y-4 mb-10 flex-grow",children:[void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-4 border-b pb-4",style:{borderColor:"var(--secondary-bg)"},children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-gray-200 rounded animate-pulse"}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,r.jsx)("div",{className:"h-4 w-3/4 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-3 w-1/2 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-3 w-1/3 bg-gray-200 rounded animate-pulse"})]})]},t))}),(0,r.jsxs)("div",{className:"border-t pt-8 space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]})]})]})}),(0,r.jsx)("div",{className:"lg:col-span-3 order-2 lg:order-1",children:(0,r.jsxs)("div",{className:"p-6 sm:p-8 w-[95%] md:w-full max-w-md sm:max-w-lg lg:max-w-2xl mx-auto min-h-[450px] flex flex-col rounded-lg shadow-md",style:{backgroundColor:"var(--primary-bg)"},children:[(0,r.jsx)("div",{className:"h-6 w-40 bg-gray-200 rounded animate-pulse mb-6"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"h-5 w-32 bg-gray-200 rounded animate-pulse"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"h-10 w-full bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-8 w-8 bg-gray-200 rounded animate-pulse"})]})]}),(0,r.jsxs)("div",{className:"my-6",children:[(0,r.jsx)("div",{className:"h-5 w-24 bg-gray-200 rounded animate-pulse mb-2"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("div",{className:"h-10 w-full bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 w-24 bg-gray-200 rounded animate-pulse"})]})]}),(0,r.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,r.jsx)("div",{className:"h-10 w-32 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 w-40 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"})]})]}),(0,r.jsx)("div",{className:"h-12 w-full bg-gray-200 rounded animate-pulse mt-6"})]})})]})]})})}function c(e){let{error:t,currentLocale:a}=e;return(0,r.jsx)("div",{className:"text-center py-10 text-red-500",role:"alert","aria-live":"polite",dir:"ar"===a?"rtl":"ltr",children:(0,r.jsx)("p",{children:t})})}var m=a(6874),u=a.n(m);function p(e){let{currentLocale:t}=e,a=(0,o.c3)("");return(0,r.jsxs)("div",{className:"text-center py-10",dir:"ar"===t?"rtl":"ltr",children:[(0,r.jsx)("p",{className:"text-lg",style:{color:"var(--text-primary)"},children:a("Cart.empty")}),(0,r.jsx)(u(),{href:"/".concat(t,"/products"),className:"mt-4 inline-block px-4 py-2 text-white rounded-md",style:{backgroundColor:"var(--accent-color)"},children:a("Cart.continueShopping")})]})}var g=a(6766),x=a(2629),h=a(3999);function f(e){let{couponApplied:t,couponDiscount:a}=e,s=(0,o.c3)(""),n="en"===(0,i.usePathname)().split("/")[1]?"en":"ar",{items:d,isLoading:c,error:m}=(0,l.useCartStore)(),p=((0,x._)(".footer"),d.reduce((e,t)=>e+(parseFloat(t.price)||0)*t.quantity,0)),f=p+2+0,y=t?f*(1-a):f;return c?(0,r.jsx)("div",{className:"text-center py-10",role:"alert","aria-live":"polite",children:(0,r.jsx)("p",{className:"text-lg",style:{color:"var(--text-primary)"},children:s("Cart.loading")})}):m?(0,r.jsx)("div",{className:"text-center py-10 text-red-500",role:"alert","aria-live":"polite",children:(0,r.jsx)("p",{children:m})}):0===d.length?(0,r.jsxs)("div",{className:"text-center py-10",children:[(0,r.jsx)("p",{className:"text-lg",style:{color:"var(--text-primary)"},children:s("Cart.empty")}),(0,r.jsx)(u(),{href:"/".concat(n,"/products"),className:"mt-4 inline-block px-4 py-2 text-white rounded-md",style:{backgroundColor:"var(--accent-color)"},children:s("Cart.continueShopping")})]}):(0,r.jsxs)("div",{className:"sticky-container p-6 sm:p-8 w-[95%] md:w-full max-w-md sm:max-w-lg lg:max-w-2xl lg:mx-7 min-h-[450px] mx-auto flex flex-col z-10 ".concat("lg:sticky lg:top-25"),role:"region","aria-label":s("checkout.orderSummary"),style:{backgroundColor:"var(--primary-bg)"},children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-10",style:{color:"var(--text-primary)"},children:s("checkout.orderSummary")}),(0,r.jsx)("div",{className:"space-y-4 mb-10 flex-grow overflow-y-auto",style:{maxHeight:"calc(50vh - 100px)"},children:d.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-4 border-b pb-4",style:{borderColor:"var(--secondary-bg)"},children:[(0,r.jsx)(u(),{href:"/".concat(n,"/products/").concat(e.product_id),className:"gap-4",passHref:!0,children:(0,r.jsx)("div",{className:"w-20 h-20 relative",children:(0,r.jsx)(g.default,{src:"http://127.0.0.1:8000"+e.image[0],alt:("ar"===n?e.name_ar:e.name_en)||"Product Image",fill:!0,className:"object-cover rounded",loading:"lazy"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-medium text-sm",style:{color:"var(--text-primary)"},children:"ar"===n?e.name_ar:e.name_en||e.name_ar}),(0,r.jsxs)("p",{className:"text-xs",style:{color:"var(--text-gray)"},children:[s("checkout.price"),": ",(0,h.$)(e.price,n)]}),(0,r.jsxs)("p",{className:"text-xs",style:{color:"var(--text-gray)"},children:[s("checkout.quantity"),": ",e.quantity]})]})]},e.id))}),(0,r.jsx)("div",{className:"border-t pt-8 mb-10",style:{borderColor:"var(--accent-color)"},children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{style:{color:"var(--text-gray)"},children:s("Cart.subtotal")}),(0,r.jsx)("span",{className:"font-medium",children:(0,h.$)(p.toFixed(2),n)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{style:{color:"var(--text-gray)"},dir:"ar"===n?"rtl":"ltr",children:s("Cart.shipping")}),(0,r.jsx)("span",{className:"font-medium",children:(0,h.$)("2.00",n)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{style:{color:"var(--text-gray)"},children:s("Cart.tax")}),(0,r.jsx)("span",{className:"font-medium",children:(0,h.$)("0.00",n)})]}),t?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{style:{color:"var(--text-gray)"},children:s("Cart.originalTotal")}),(0,r.jsx)("span",{className:"line-through",children:(0,h.$)(f.toFixed(2),n)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-xl font-semibold",children:s("Cart.discountedTotal")}),(0,r.jsx)("span",{className:"text-xl font-bold",children:(0,h.$)(y.toFixed(2),n)})]})]}):(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-xl font-semibold",children:s("Cart.total")}),(0,r.jsx)("span",{className:"text-xl font-bold",children:(0,h.$)(f.toFixed(2),n)})]})]})})]})}var y=a(9365),v=a.n(y);a(133);var N=a(381),b=a(4105);function j(e){let{userData:t,addresses:a,setAddresses:i,defaultAddressId:l,formData:d,formErrors:c,handleGiftInputChange:m,handleGiftPhoneChange:p,handleGiftToggle:g,currentLocale:x,setDefaultAddressId:h}=e,f=(0,o.c3)("checkout"),y=(0,s.useRef)(t.phone_number),j=(0,s.useRef)(d.giftPhoneNumber),[w,_]=(0,s.useState)(void 0),C=async e=>{let t=parseInt(e.target.value);if(!t){_(f("errors.addressRequired")),h(null);return}try{await (0,n.y_)(t),i(a.map(e=>({...e,is_default:e.id===t}))),h(t),_(void 0)}catch(e){console.error("Error setting default address:",e),_(f("errors.addressChangeFailed"))}};return(0,r.jsxs)("div",{className:"space-y-6",dir:"ar"===x?"rtl":"ltr",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--text-primary)"},children:f("billingDetails")}),(0,r.jsxs)(b.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-[var(--text-primary)]",children:f("firstName")}),(0,r.jsx)("input",{type:"text",name:"first_name",value:t.first_name,disabled:!0,className:"w-full rounded-lg border px-4 py-3 text-sm bg-gray-100 cursor-not-allowed border-[var(--secondary-bg)]","aria-label":f("firstName")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-[var(--text-primary)]",children:f("lastName")}),(0,r.jsx)("input",{type:"text",name:"last_name",value:t.last_name,disabled:!0,className:"w-full rounded-lg border px-4 py-3 text-sm bg-gray-100 cursor-not-allowed border-[var(--secondary-bg)]","aria-label":f("lastName")})]})]}),(0,r.jsxs)(b.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"mb-6",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-[var(--text-primary)]",children:f("phoneNumber")}),(0,r.jsx)("div",{dir:"ltr",children:(0,r.jsx)(v(),{country:"jo",value:y.current||"",disabled:!0,containerClass:"w-full",inputProps:{name:"phone_number",className:"w-full pl-16 py-3 rounded-lg border text-sm bg-gray-100 cursor-not-allowed border-[var(--secondary-bg)]"},buttonStyle:{border:"none",backgroundColor:"transparent",padding:"8px",cursor:"not-allowed",left:"0",top:"0",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},dropdownStyle:{display:"none"}})})]}),(0,r.jsxs)(b.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"mb-6",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-[var(--text-primary)]",children:f("address")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("select",{name:"address",value:l||"",onChange:C,className:"w-full rounded-lg border px-4 py-3 text-sm focus:outline-none focus:ring-2 transition-colors ".concat(w?"border-red-500":"border-[var(--secondary-bg)]"),"aria-invalid":!!w,"aria-describedby":w?"address-error":void 0,children:[(0,r.jsx)("option",{value:"",children:f("selectAddress")}),a.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.title," - ",e.city,", ",e.country_name||e.country_id]},e.id))]}),(0,r.jsx)(u(),{href:"/".concat(x,"/address"),children:(0,r.jsx)(b.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",className:"p-2 text-[var(--text-gray)] hover:text-[var(--accent-color)]",title:f("manageAddresses"),children:(0,r.jsx)(N.A,{className:"w-5 h-5"})})})]}),w&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",id:"address-error",children:w})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 my-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"isGift",checked:d.isGift,onChange:g,className:"h-4 w-4"}),(0,r.jsx)("label",{htmlFor:"isGift",className:"text-sm",style:{color:"var(--text-primary)"},children:f("isGift")})]}),d.isGift&&(0,r.jsxs)(b.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"space-y-4 mt-4 my-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",name:"giftFirstName",placeholder:f("giftFirstName"),value:d.giftFirstName,onChange:m,className:"w-full rounded-md border px-4 py-3 text-sm focus:outline-none focus:ring-2 transition-colors ".concat(c.giftFirstName?"border-red-500":"border-[var(--secondary-bg)]"),"aria-invalid":!!c.giftFirstName,"aria-describedby":c.giftFirstName?"giftFirstName-error":void 0}),c.giftFirstName&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",id:"giftFirstName-error",children:c.giftFirstName})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",name:"giftLastName",placeholder:f("giftLastName"),value:d.giftLastName,onChange:m,className:"w-full rounded-md border px-4 py-3 text-sm focus:outline-none focus:ring-2 transition-colors ".concat(c.giftLastName?"border-red-500":"border-[var(--secondary-bg)]"),"aria-invalid":!!c.giftLastName,"aria-describedby":c.giftLastName?"giftLastName-error":void 0}),c.giftLastName&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",id:"giftLastName-error",children:c.giftLastName})]})]}),(0,r.jsxs)("div",{dir:"ltr",children:[(0,r.jsx)(v(),{country:"jo",value:j.current||"",onChange:e=>{j.current=e,p(e)},containerClass:"w-full",inputProps:{name:"giftPhoneNumber",required:!0,className:"w-full pl-16 py-3 rounded-md border text-sm focus:outline-none focus:ring-2 transition-colors ".concat(c.giftPhoneNumber?"border-red-500":"border-[var(--secondary-bg)]")},buttonStyle:{border:"none",backgroundColor:"transparent",padding:"8px",cursor:"pointer",left:"0",top:"0",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},dropdownStyle:{zIndex:1e3,top:"100%",left:"0"}}),c.giftPhoneNumber&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",id:"giftPhoneNumber-error",children:c.giftPhoneNumber})]})]})]})}var w=a(1586);function _(e){let{paymentMethod:t,handlePaymentMethodChange:a}=e,s=(0,o.c3)("checkout");return(0,r.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,r.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("credit-card"===t?"bg-[var(--secondary-bg)] text-[var(--text-white)]":"bg-[var(--primary-bg)] text-[var(--text-gray)] hover:bg-[var(--secondary-bg)] hover:text-[var(--text-white)]"),onClick:()=>a("credit-card"),"aria-pressed":"credit-card"===t,children:[(0,r.jsx)(w.A,{className:"h-4 w-4"}),s("creditCard")]}),(0,r.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("cash"===t?"bg-[var(--secondary-bg)] text-[var(--text-white)]":"bg-[var(--primary-bg)] text-[var(--text-gray)] hover:bg-[var(--secondary-bg)] hover:text-[var(--text-white)]"),onClick:()=>a("cash"),"aria-pressed":"cash"===t,children:[(0,r.jsx)("span",{className:"text-lg",children:"$"}),s("cashOnDelivery")]})]})}var C=a(1154),k=a(8868),S=a(4477);let L=(0,S.createServerReference)("70c6f63c93dd4840043497687d65c268e56370956e",S.callServer,void 0,S.findSourceMapURL,"createCheckoutSession");function F(e){let{formData:t,setFormErrors:a,isProcessing:s,setIsProcessing:l,currentLocale:d,items:c,userData:m,addresses:u,defaultAddressId:p,total:g,couponApplied:x,couponDiscount:h}=e,f=(0,o.c3)("checkout"),y=(0,i.useRouter)(),v=u.find(e=>e.id===p)||null,N=()=>{let e={};if(t.isGift){t.giftFirstName.trim()||(e.giftFirstName=f("errors.giftFirstNameRequired")),t.giftLastName.trim()||(e.giftLastName=f("errors.giftLastNameRequired"));let a=(0,k.l)("+".concat(t.giftPhoneNumber));a&&a.isValid()||(e.giftPhoneNumber=f("errors.invalidGiftPhone"))}return e},j=async()=>{var e,r,s,i;if(!v||!(null===(e=v.address_line)||void 0===e?void 0:e.trim())){a({address:f("errors.addressIncomplete")});return}let o=N();if(Object.keys(o).length>0){a(o),o.giftFirstName?null===(r=document.getElementsByName("giftFirstName")[0])||void 0===r||r.focus():o.giftLastName?null===(s=document.getElementsByName("giftLastName")[0])||void 0===s||s.focus():o.giftPhoneNumber&&(null===(i=document.getElementsByName("giftPhoneNumber")[0])||void 0===i||i.focus());return}l(!0);try{let e=localStorage.getItem("userId"),a=localStorage.getItem("token");if(!e)throw Error("User ID not found");if(!a)throw Error("Authentication token not found");let r=localStorage.getItem("appliedCoupon"),s=r?JSON.parse(r):null,i=x&&h>0?g-h:g,l={customer_id:e,address_id:p,items:c.map(e=>({product_id:e.product_id,price:e.price.toString(),quantity:e.quantity,name_ar:e.name_ar,name_en:e.name_en})),is_gift:t.isGift,gift_first_name:t.isGift?t.giftFirstName:void 0,gift_last_name:t.isGift?t.giftLastName:void 0,gift_phone_number:t.isGift?t.giftPhoneNumber:void 0,coupon_id:x&&s?s.id:null,total:i,delivery_cost:2,orderCode:"ORD"+new Date().getTime().toString(),payment_method:t.paymentMethod,address_line:v.address_line,city:v.city,country_name:v.country_name};if("cash"===t.paymentMethod){let r=await (0,n.Pt)(l,a),s={orderId:r&&r.data.order_code.toString(),items:c.map(e=>({id:e.product_id.toString(),name_ar:e.name_ar,name_en:e.name_en,quantity:e.quantity,price:e.price.toString()})),total:i.toFixed(3),orderDate:new Date().toISOString(),couponApplied:x,couponDiscount:h,billing:{first_name:t.isGift?t.giftFirstName:m.first_name,last_name:t.isGift?t.giftLastName:m.last_name,phone_number:t.isGift?t.giftPhoneNumber:m.phone_number,address_line:v.address_line,city:v.city,country:v.country_name},gift:t.isGift?{firstName:t.giftFirstName,lastName:t.giftLastName,phoneNumber:t.giftPhoneNumber}:null};localStorage.setItem("lastOrder",JSON.stringify(s)),await (0,n.sX)(e,d,a),x&&localStorage.removeItem("appliedCoupon"),y.push("/".concat(d,"/success"))}else if("credit-card"===t.paymentMethod){let t={orderNumber:l.orderCode||"",customerName:"".concat(m.first_name," ").concat(m.last_name),customerEmail:m.email||"UNKNOWN",userId:e,couponDiscount:x?h:void 0,finalTotal:i,checkoutData:JSON.stringify(l)},a=await L(c,t,d);a&&(window.location.href=a)}}catch(e){console.error("Checkout error:",e),a({general:f("errors.checkoutFailed")})}finally{l(!1)}},w=()=>{var e,a,r,i,l,n;return!!(s||0===c.length||!v||t.isGift&&(!(null===(i=t.giftFirstName)||void 0===i?void 0:i.trim())||!(null===(l=t.giftLastName)||void 0===l?void 0:l.trim())||!(null===(n=t.giftPhoneNumber)||void 0===n?void 0:n.trim()))||"cash"===t.paymentMethod&&((null===(e=t.giftFirstName)||void 0===e?void 0:e.trim())||(null===(a=t.giftLastName)||void 0===a?void 0:a.trim())||(null===(r=t.giftPhoneNumber)||void 0===r?void 0:r.trim())))||(t.paymentMethod,!1)};return(0,r.jsx)(b.P.button,{onClick:j,disabled:w(),className:"w-full py-4 mt-6 text-white font-medium rounded-md transition-colors flex items-center justify-center ".concat(w()?"bg-gray-400 cursor-not-allowed":"bg-[var(--secondary-bg)] hover:bg-[var(--accent-color)]"),"aria-label":s?f("processing"):f("confirm"),initial:{opacity:0,y:10},animate:{opacity:1,y:0},whileHover:w()?{}:{scale:1.05,boxShadow:"0 0 8px rgba(0, 0, 0, 0.2)"},children:s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.A,{className:"animate-spin h-5 w-5 mr-2"}),f("processing")]}):f("confirm")})}function P(e){let{userData:t,addresses:a,setAddresses:d,defaultAddressId:c,setDefaultAddressId:m,couponCode:u,setCouponCode:p,couponApplied:g,setCouponApplied:f,couponDiscount:y,setCouponDiscount:v,couponError:N,setCouponError:b}=e,w=(0,o.c3)("checkout"),C="en"===(0,i.usePathname)().split("/")[1]?"en":"ar",{items:k}=(0,l.useCartStore)(),[S,L]=((0,x._)(".footer"),(0,s.useState)(!1)),[P,I]=(0,s.useState)({cardNumber:"",cardHolder:"",expiryDate:"",cvv:"",paymentMethod:"credit-card",isGift:!1,giftFirstName:"",giftLastName:"",giftPhoneNumber:""}),[A,D]=(0,s.useState)({}),[E,q]=(0,s.useState)([]);(0,s.useEffect)(()=>{(async()=>{try{let e=await (0,n.w6)();q(e)}catch(e){console.error("Failed to fetch coupons:",e),b(w("errors.failedToLoadCoupons"))}})()},[w,b]);let G=k.reduce((e,t)=>e+(parseFloat(t.price)||0)*t.quantity,0)+0,O=(g?G*(1-y):G)+2,M=a.find(e=>e.id===c),R=(null==M?void 0:M.country_id)||null,$=async()=>{try{let e=await (0,n.VY)(u,R);f(!0),v(e.data.amount/100),b(null),localStorage.setItem("appliedCoupon",JSON.stringify(e.data))}catch(t){let e=t instanceof Error?t:Error(w("errors.invalidCoupon"));f(!1),v(0),b(e.message),localStorage.removeItem("appliedCoupon")}};return(0,r.jsxs)("div",{className:"sticky-container p-6 sm:p-8 w-[95%] md:w-full max-w-md sm:max-w-lg lg:max-w-2xl mx-auto lg:mx-7 min-h-[450px] sm:mx-auto md:mx-auto flex flex-col z-10 rounded-lg shadow-md ".concat("lg:sticky lg:top-25"),style:{backgroundColor:"var(--primary-bg)",borderColor:"var(--secondary-bg)"},role:"region","aria-label":w("paymentDetails"),children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-6",style:{color:"var(--text-primary)"},children:w("paymentDetails")}),(0,r.jsx)(j,{userData:t,addresses:a,setAddresses:d,defaultAddressId:c,setDefaultAddressId:m,formData:P,formErrors:A,handleGiftInputChange:e=>{let{name:t,value:a}=e.target;I(e=>({...e,[t]:a})),D(e=>({...e,[t]:void 0}))},handleGiftPhoneChange:e=>{I(t=>({...t,giftPhoneNumber:e})),D(e=>({...e,giftPhoneNumber:void 0}))},handleGiftToggle:()=>{I(e=>({...e,isGift:!e.isGift,giftFirstName:"",giftLastName:"",giftPhoneNumber:""})),D(e=>({...e,giftFirstName:void 0,giftLastName:void 0,giftPhoneNumber:void 0}))},currentLocale:C}),E.length>0&&(0,r.jsxs)("div",{className:"my-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",style:{color:"var(--text-primary)"},children:w("coupon")}),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("span",{className:"text-sm",style:{color:"var(--text-gray)"},children:[w("couponCode"),":"]}),E.map(e=>(0,r.jsx)("span",{className:"text-cyan-700 ml-2",children:e.code},e.id))]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:u,onChange:e=>{p(e.target.value),b(null)},placeholder:w("enterCoupon"),className:"w-full rounded-md border px-4 py-3 text-sm focus:outline-none focus:ring-2 transition-colors border-[var(--secondary-bg)]"}),(0,r.jsx)("button",{onClick:$,className:"px-4 py-2 text-white rounded-md",style:{backgroundColor:"var(--accent-color)"},children:w("applyCoupon")})]}),N&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:N}),g&&(0,r.jsxs)("div",{className:"text-sm mt-2",style:{color:"var(--text-gray)"},children:[(0,r.jsxs)("p",{children:[w("originalTotal"),":"," ",(0,r.jsx)("span",{className:"line-through",children:(0,h.$)(G.toFixed(2),C)})]}),(0,r.jsxs)("p",{children:[w("discountedTotal"),":"," ",(0,r.jsx)("span",{className:"font-bold",children:(0,h.$)(O.toFixed(2),C)})]})]})]}),(0,r.jsx)(_,{paymentMethod:P.paymentMethod,handlePaymentMethodChange:e=>{I(t=>({...t,paymentMethod:e})),D({})}}),(0,r.jsx)(F,{formData:P,setFormErrors:D,isProcessing:S,setIsProcessing:L,currentLocale:C,items:k,userData:t,addresses:a,defaultAddressId:c,total:O,couponApplied:g,couponDiscount:y})]})}function I(e){let{userData:t,addresses:a,setAddresses:s,defaultAddressId:i,setDefaultAddressId:l,couponCode:n,setCouponCode:o,couponApplied:d,setCouponApplied:c,couponDiscount:m,setCouponDiscount:u,couponError:p,setCouponError:g,currentLocale:x}=e;return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 sm:gap-6 lg:gap-8",dir:"ar"===x?"rtl":"ltr",children:[(0,r.jsx)("div",{className:"lg:col-span-2 sm:py-6 lg:py-0 order-1 lg:order-2",children:(0,r.jsx)(f,{couponApplied:d,couponDiscount:m})}),(0,r.jsx)("div",{className:"lg:col-span-3 order-2 lg:order-1",children:(0,r.jsx)(P,{userData:t,addresses:a,setAddresses:s,defaultAddressId:i,setDefaultAddressId:l,couponCode:n,setCouponCode:o,couponApplied:d,setCouponApplied:c,couponDiscount:m,setCouponDiscount:u,couponError:p,setCouponError:g,currentLocale:x})})]})}var A=a(1004);function D(e){let{currentLocale:t}=e,a=(0,o.c3)("");return(0,r.jsxs)("div",{className:"mb-8",dir:"ar"===t?"rtl":"ltr",children:[(0,r.jsx)(A.A,{pageName:"checkout"}),(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold mt-4",style:{color:"var(--text-primary)"},children:a("checkout.title")})]})}function E(){let e=(0,i.usePathname)(),t=(0,i.useRouter)(),a="en"===e.split("/")[1]?"en":"ar",{items:o,syncWithBackend:m,isLoading:u,error:g}=(0,l.useCartStore)(),[x,h]=(0,s.useState)(null),[f,y]=(0,s.useState)([]),[v,N]=(0,s.useState)(null),[b,j]=(0,s.useState)(!0),[w,_]=(0,s.useState)(""),[C,k]=(0,s.useState)(!1),[S,L]=(0,s.useState)(0),[F,P]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),r=localStorage.getItem("userId");if(!e||!r){t.push("/".concat(a,"/login?redirect=/checkout"));return}(async()=>{try{j(!0);let[e,t]=await Promise.all([(0,n.eO)(),(0,n.ls)()]);h({first_name:e.first_name,last_name:e.last_name,phone_number:e.phone_number,email:e.email}),y(t);let s=t.find(e=>e.is_default);N(s?s.id:null),r&&await m(r,a)}catch(e){console.error("Error fetching data:",e)}finally{j(!1)}})()},[a,t,e,m]),(0,r.jsx)("div",{className:"min-h-screen flex flex-col",style:{backgroundColor:"var(--primary-bg)"},dir:"ar"===a?"rtl":"ltr",children:(0,r.jsxs)("main",{className:"container mx-auto max-w-full sm:max-w-7xl px-4 sm:px-6 lg:px-8 py-8 flex-grow",children:[(0,r.jsx)(D,{currentLocale:a}),b||!x?(0,r.jsx)(d,{currentLocale:a}):u?(0,r.jsx)(d,{currentLocale:a}):g?(0,r.jsx)(c,{error:g,currentLocale:a}):0===o.length?(0,r.jsx)(p,{currentLocale:a}):(0,r.jsx)(I,{userData:x,addresses:f,setAddresses:y,defaultAddressId:v,setDefaultAddressId:N,couponCode:w,setCouponCode:_,couponApplied:C,setCouponApplied:k,couponDiscount:S,setCouponDiscount:L,couponError:F,setCouponError:P,currentLocale:a})]})})}},8059:(e,t,a)=>{Promise.resolve().then(a.bind(a,7776))},9946:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(2115);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),l=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:d="",children:c,iconNode:m,...u}=e;return(0,r.createElement)("svg",{ref:t,...o,width:s,height:s,stroke:a,strokeWidth:l?24*Number(i)/Number(s):i,className:n("lucide",d),...u},[...m.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(c)?c:[c]])}),c=(e,t)=>{let a=(0,r.forwardRef)((a,i)=>{let{className:o,...c}=a;return(0,r.createElement)(d,{ref:i,iconNode:t,className:n("lucide-".concat(s(l(e))),"lucide-".concat(e),o),...c})});return a.displayName=l(e),a}}},e=>{var t=t=>e(e.s=t);e.O(0,[7540,7652,7244,4105,6766,129,4779,6720,8441,1684,7358],()=>t(8059)),_N_E=e.O()}]);